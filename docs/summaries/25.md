Meeting summary for Infrastructure. Mailing. Activation | Python Pro (27.02.2025) Дмитро Парфенюк (02/27/2025)

# Quick recap

Нарада була зосереджена на реалізації мінімального проекту з такими важливими компонентами, як кеш, черга та база даних, а також на створенні служби електронної пошти для активації користувачів. Команда обговорила різні технічні аспекти, включаючи використання Docker, генерацію унікальних ідентифікаторів та впровадження класів серіалізаторів для перевірки даних. Під час зустрічі вони досліджували різні підходи до управління користувачами, надсилання електронної пошти та обробки помилок, а також розглядали потенційні проблеми безпеки та найкращі практики розробки.
Next steps
• Команда розробників для реалізації функціоналу активації користувача за допомогою електронної пошти та активаційних ключів.
• Команда розробників для налаштування Mailpit для тестування функціональності електронної пошти в середовищі розробки.
• Команда розробників для реалізації механізму кешування для тимчасового зберігання активаційних ключів.
• Команда розробників оновила модель User, щоб включити поле 'is_active' та реалізувати логіку оновлення після успішної активації.
• Команда розробників для створення ActivationSerializer для обробки запитів активації.
• Команда розробників реалізує обробку помилок для процесу активації, включаючи випадки, коли активаційні ключі недійсні або минули.
• Команда розробників повинна розглянути можливість впровадження більш надійного рішення кешування в майбутньому, такого як Redis.
• Команда розробників для впровадження робочої системи для обробки фонових завдань в майбутніх ітераціях.
• Команда розробників для перегляду та оптимізації поточної реалізації транзакцій в Django для кращої узгодженості даних.
• Команда розробників для впровадження належного тестування для потоку активації користувача, включаючи модульні тести та інтеграційні тести.

# Summary

## Мінімальні компоненти проекту та кешування

Дмитро обговорив реалізацію мінімального проекту, підкресливши важливість трьох додаткових компонентів: кешу, черги та бази даних. Він пояснив, що кеш зменшує навантаження на базу даних, зберігаючи часто доступні дані, в той час як черга гарантує, що запити обробляються ефективно. Дмитро також підкреслив роль черги в обробці довгих відповідей зі сторонніх ресурсів, а також використання кешування для уникнення перевантаження бази даних. Він зробив висновок, зазначивши про необхідність реалізації функції активації профілю користувача для боротьби з ботами і захисту від підроблених користувачів.
Використання Docker та активація користувачів
Дмитро обговорив використання Docker для розробки та налагодження проектів. Він пояснив, що зміни в проекті призведуть до змін всередині контейнера, і запропонував використовувати різні механізми для налагодження, такі як додавання відбитків в журнали Docker або використання консольних відладчиків. Дмитро також запропонував спростити систему, запустивши Epic і зберігши її в Docker, і використовуючи Docker Compose для перевизначення параметрів. Він продемонстрував, як створити користувача в системі і як активувати його через електронну пошту з кодом активації. На завершення Дмитро запропонував створити сервіс для активації користувачів.

## Розробка компонента поштового сервісу

Дмитро обговорив розробку компонента поштового сервісу для їх застосування. Він пояснив, що вони створять окремий компонент інфраструктури, використовуючи протоколи і сервіси, такі як ESM, Skip і SES, для обробки електронної кореспонденції. Він продемонстрував, як надсилати електронні листи, використовуючи приклад коду Python, наводячи приклади постачальників, таких як SendGrid. Дмитро також представив Mail Hook як інструмент для тестування логіки електронної пошти та візуалізував інфраструктуру з додатком, базою даних, тригером подій, поштовим сервісом та працівником. Команда обговорила необхідність вирішити, де зберігати інформацію про користувача, будь то кеш або в базі даних. Дмитро запропонував почати з кеш-підходу і використовувати кеш в пам'яті Python, згадавши про майбутню міграцію на Redis, якщо це необхідно. Він запропонував функціональний підхід до їх розробки, використовуючи псевдокод як відправну точку.

## Клас активатора для створення служби електронної пошти

Дмитро обговорив створення класу під назвою «Активатор» для поштового сервісу. Він пояснив, як працює сервіс, в тому числі, як він створює активи та облігації. Він також згадав про можливість використання гібридного підходу та використання функцій. Дмитро показав, як можна використовувати сервіс для відправки користувачу активаційного листа, а також пояснив, як фронтенд отримує цей лист і формує запит на бекенд. Він також згадав про використання кешу для управління активаційними ключами, які діють протягом певного періоду часу.

## Покращений підхід до управління інформацією користувачів

Дмитро обговорив проблеми зберігання та управління інформацією користувачів, запропонувавши більш структурований підхід з використанням словника або хеш-мапи. Він також запропонував підхід на основі класу для обробки активації користувача та перевірки електронної пошти. Дмитро пояснив поняття геш-функцій та їх використання при генерації унікальних ключів, підкресливши важливість вибору правильного алгоритму на основі чутливості даних. Він також торкнувся потенційних ризиків використання певних хеш-функцій, таких як MD5, і необхідності більш безпечного підходу. Команда погодилася розглянути ці пропозиції і надалі вдосконалювати свій підхід.

## Конфігурація Jangomail та унікальний процес ідентифікації

Дмитро обговорив процес генерації унікального ідентифікатора (UID) для кожної активаційної літери, підкресливши важливість випадковості. Він пояснив, як створити посилання на основі UID, і як відправити посилання через бічний сервіс. Дмитро також обговорив необхідність використання правильного протоколу при відправці електронних листів через бічний сервіс, і як це реалізувати в проекті за допомогою модуля Jangomail. Він навів приклади того, як налаштувати модуль і вказав параметри для відправки електронної пошти. Дмитро наголосив на важливості розуміння конфігурації Jangomail та поставив під сумнів необхідність подальших роз’яснень щодо процесу впровадження.

## Конфігурації та тестування Backend електронної пошти

Дмитро обговорив функціональні можливості та конфігурації різних бекендів електронної пошти, включаючи стандартний Django бекенд та Consolidated Backend. Він пояснив, як використовувати ці бекенди для тестування відправки електронної пошти, включаючи використання служб MailHawk і MailPit. Дмитро також наголосив на важливості використання транзакцій у Django для запобігання помилок у базах даних. Він продемонстрував, як встановити та налаштувати ці бекенди, а також як протестувати процес надсилання електронної пошти. Розмова закінчилася тим, що Дмитро показав, як отримати доступ до бекенда електронної пошти через браузер.

## Дмитро обговорює процес активації користувача

Дмитро обговорив процес активації користувача, ідентифікованого як Джон, включивши кілька кроків, таких як створення нового ендоїда, перейменування ключа та використання акт-декоратора. Він також торкнувся можливості самоактивації для нових користувачів і використання різних параметрів і класів. Дмитро зіткнувся з помилкою, пов’язаною зі значенням дії, яку він намагався вирішити. Він також згадав про встановлення відладчика і знову запустив сервер. Однак він зіткнувся з проблемою токана і сутністю нейрокані.

## Перевірка активації користувача та серіалізація

Дмитро обговорив впровадження класу серіалізаторів для валідації та представлення даних активації користувача. Він створив клас Serializer для перевірки даних активації користувача, включаючи метод перевірки на валідність і представлення значення. Дмитро також обговорив впровадження кеш-сервісу для зберігання даних активації користувачів. Він окреслив процес отримання даних з кешу та оновлення інформації користувача. Дмитро також продемонстрував, як обробляти помилки в процесі активації та обговорив використання моделі користувача Django для управління користувачами. Він закінчив розмову, зазначивши, що вони були майже виконані з базовим функціоналом і заплановані на ще два уроки.
